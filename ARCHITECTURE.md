# ğŸ—ï¸ é¡¹ç›®æ¶æ„è¯´æ˜

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜äº†åŠ æ‹¿å¤§é©¾è€ƒAppçš„Monorepoæ¶æ„è®¾è®¡ã€‚

## ğŸ“‹ æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Root Workspace                       â”‚
â”‚                     (canadian-driving-test)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“¦ Bun Workspaces + Turborepo + TypeScript References     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸ“± Apps       â”‚   ğŸ“¦ Packages   â”‚       ğŸ› ï¸ Tools         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ mobile        â”‚ â€¢ shared        â”‚ â€¢ Turborepo             â”‚
â”‚ â€¢ admin (å¾…åˆ›å»º) â”‚ â€¢ database      â”‚ â€¢ TypeScript            â”‚
â”‚                 â”‚                 â”‚ â€¢ Drizzle Kit           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ è®¾è®¡åŸåˆ™

### 1. **ç±»å‹å®‰å…¨ä¼˜å…ˆ**
- æ‰€æœ‰æ•°æ®ç»“æ„åœ¨ `shared` åŒ…ä¸­å®šä¹‰
- æ•°æ®åº“ schema è‡ªåŠ¨ç”Ÿæˆ TypeScript ç±»å‹
- ç¼–è¯‘æ—¶å’Œè¿è¡Œæ—¶åŒé‡ç±»å‹éªŒè¯

### 2. **ä»£ç å¤ç”¨æœ€å¤§åŒ–**
- ä¸šåŠ¡é€»è¾‘ã€éªŒè¯è§„åˆ™ã€å¸¸é‡åœ¨å„åº”ç”¨é—´å…±äº«
- é¿å…é‡å¤ä»£ç ï¼Œç¡®ä¿ä¸€è‡´æ€§

### 3. **å¼€å‘ä½“éªŒä¼˜åŒ–**
- ç»Ÿä¸€çš„æ„å»ºå’Œéƒ¨ç½²æµç¨‹
- å¿«é€Ÿçš„ç±»å‹æ£€æŸ¥å’Œçƒ­é‡è½½
- æ¸…æ™°çš„ä¾èµ–å…³ç³»

## ğŸ“¦ åŒ…èŒè´£è¯¦è§£

### ğŸ  æ ¹å·¥ä½œç©ºé—´ (Root Workspace)

**èŒè´£**: 
- ç®¡ç†æ‰€æœ‰å­åŒ…çš„ä¾èµ–
- æä¾›ç»Ÿä¸€çš„è„šæœ¬å…¥å£
- é…ç½®æ„å»ºå·¥å…·é“¾

**å…³é”®æ–‡ä»¶**:
```
package.json          # Workspace é…ç½®å’Œè„šæœ¬
turbo.json           # æ„å»ºä¼˜åŒ–é…ç½®
tsconfig.json        # TypeScript æ ¹é…ç½®
```

### ğŸ“± Apps - åº”ç”¨å±‚

#### `apps/mobile` - React Native åº”ç”¨

**èŒè´£**:
- ç”¨æˆ·ç•Œé¢å’Œäº¤äº’é€»è¾‘
- ç§»åŠ¨ç«¯ç‰¹å®šåŠŸèƒ½ (ç›¸æœºã€æ¨é€ç­‰)
- æœ¬åœ°çŠ¶æ€ç®¡ç† (Zustand)

**æŠ€æœ¯æ ˆ**:
```typescript
â”œâ”€â”€ Expo Router        # è·¯ç”±ç®¡ç†
â”œâ”€â”€ NativeWind         # æ ·å¼ç³»ç»Ÿ
â”œâ”€â”€ Zustand           # çŠ¶æ€ç®¡ç†
â”œâ”€â”€ React Query       # æ•°æ®è·å–
â””â”€â”€ Expo SDK          # åŸç”ŸåŠŸèƒ½
```

**ç›®å½•ç»“æ„**:
```
apps/mobile/
â”œâ”€â”€ app/              # é¡µé¢è·¯ç”± (Expo Router)
â”œâ”€â”€ components/       # å¯å¤ç”¨ç»„ä»¶
â”œâ”€â”€ hooks/           # è‡ªå®šä¹‰ Hooks
â”œâ”€â”€ stores/          # Zustand çŠ¶æ€ç®¡ç†
â”œâ”€â”€ utils/           # ç§»åŠ¨ç«¯å·¥å…·å‡½æ•°
â””â”€â”€ assets/          # é™æ€èµ„æº
```

#### `apps/admin` - Next.js ç®¡ç†åå° (å¾…åˆ›å»º)

**èŒè´£**:
- ç®¡ç†å‘˜ç•Œé¢
- é¢˜åº“ç®¡ç†
- ç”¨æˆ·æ•°æ®åˆ†æ
- API æœåŠ¡æä¾›

**æŠ€æœ¯æ ˆ**:
```typescript
â”œâ”€â”€ Next.js 14        # å…¨æ ˆæ¡†æ¶
â”œâ”€â”€ NextAuth.js       # è®¤è¯ç³»ç»Ÿ
â”œâ”€â”€ Tailwind CSS      # æ ·å¼æ¡†æ¶
â”œâ”€â”€ Drizzle ORM       # æ•°æ®åº“æ“ä½œ
â””â”€â”€ Neon Database     # PostgreSQL æ•°æ®åº“
```

### ğŸ“¦ Packages - å…±äº«å±‚

#### `packages/shared` - å…±äº«ç±»å‹å’Œå·¥å…·

**èŒè´£**:
- å®šä¹‰æ‰€æœ‰ä¸šåŠ¡ç±»å‹
- æä¾›é€šç”¨å·¥å…·å‡½æ•°
- æ•°æ®éªŒè¯è§„åˆ™ (Zod)
- å›½é™…åŒ–èµ„æº

**ç±»å‹å®šä¹‰**:
```typescript
types/
â”œâ”€â”€ user.ts          # ç”¨æˆ·ç›¸å…³ç±»å‹
â”œâ”€â”€ quiz.ts          # æµ‹éªŒç›¸å…³ç±»å‹
â”œâ”€â”€ handbook.ts      # æ‰‹å†Œç›¸å…³ç±»å‹
â”œâ”€â”€ api.ts           # API å“åº”ç±»å‹
â””â”€â”€ index.ts         # ç»Ÿä¸€å¯¼å‡º
```

**å·¥å…·å‡½æ•°**:
```typescript
utils/
â”œâ”€â”€ constants.ts     # åº”ç”¨å¸¸é‡
â”œâ”€â”€ validation.ts    # éªŒè¯å‡½æ•°
â””â”€â”€ helpers.ts       # é€šç”¨è¾…åŠ©å‡½æ•°
```

**ä½¿ç”¨ç¤ºä¾‹**:
```typescript
// åœ¨ç§»åŠ¨ç«¯ä½¿ç”¨
import { User, Province, RegisterSchema } from 'shared';

// åœ¨åç«¯ä½¿ç”¨
import { API_ENDPOINTS, ERROR_CODES } from 'shared';
```

#### `packages/database` - æ•°æ®åº“å±‚

**èŒè´£**:
- æ•°æ®åº“ Schema å®šä¹‰
- è¿ç§»æ–‡ä»¶ç®¡ç†
- ç§å­æ•°æ®
- æ•°æ®åº“è¿æ¥é…ç½®

**Schema è®¾è®¡**:
```typescript
schema/
â”œâ”€â”€ users.ts         # ç”¨æˆ·è¡¨
â”œâ”€â”€ quizzes.ts       # æµ‹éªŒè¡¨
â”œâ”€â”€ handbooks.ts     # æ‰‹å†Œè¡¨
â””â”€â”€ index.ts         # ç»Ÿä¸€å¯¼å‡º
```

**ç±»å‹ç”Ÿæˆæµç¨‹**:
```
1. å®šä¹‰ Drizzle Schema â†’ 
2. ç”Ÿæˆè¿ç§»æ–‡ä»¶ â†’ 
3. è‡ªåŠ¨ç”Ÿæˆ TypeScript ç±»å‹ â†’ 
4. åœ¨ shared åŒ…ä¸­ä½¿ç”¨
```

## ğŸ”„ æ•°æ®æµæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ•°æ®æµå‘å›¾                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Database (Neon PostgreSQL)
    â†•ï¸ (Drizzle ORM)
Admin Backend (Next.js API)
    â†•ï¸ (HTTP/WebSocket)
Mobile Frontend (React Native)
    â†•ï¸ (React Query)
Local State (Zustand)
    â†•ï¸
UI Components
```

### ç±»å‹å®‰å…¨æµ

```
Database Schema (Drizzle)
    â†“ (è‡ªåŠ¨ç”Ÿæˆ)
TypeScript Types
    â†“ (å¯¼å…¥)
Shared Package
    â†“ (å·¥ä½œåŒºä¾èµ–)
Mobile App â†â†’ Admin App
```

## ğŸ› ï¸ å¼€å‘å·¥å…·é“¾

### æ„å»ºç³»ç»Ÿ

```mermaid
graph TD
    A[å¼€å‘è€…ä¿®æ”¹ä»£ç ] --> B[TypeScript ç¼–è¯‘]
    B --> C[Turborepo æ„å»ºä¼˜åŒ–]
    C --> D[ç”Ÿæˆäº§ç‰©]
    D --> E[ç±»å‹æ£€æŸ¥]
    E --> F[æµ‹è¯•è¿è¡Œ]
    F --> G[éƒ¨ç½²å°±ç»ª]
```

### åŒ…ä¾èµ–å…³ç³»

```
database â† shared â† mobile
                 â† admin
```

**è¯´æ˜**:
- `database` ä¸ä¾èµ–ä»»ä½•å†…éƒ¨åŒ…
- `shared` ä¾èµ– `database` ç”Ÿæˆçš„ç±»å‹
- `mobile` å’Œ `admin` ä¾èµ– `shared` åŒ…

## ğŸ” ç±»å‹å®‰å…¨ä¿éšœ

### 1. ç¼–è¯‘æ—¶æ£€æŸ¥
```typescript
// åœ¨ shared åŒ…ä¸­å®šä¹‰
export interface User {
  id: string;
  email: string;
  province: Province;
}

// åœ¨ç§»åŠ¨ç«¯ä½¿ç”¨ - è‡ªåŠ¨ç±»å‹æç¤ºå’Œæ£€æŸ¥
const user: User = {
  id: "123",
  email: "user@example.com",
  province: "AB" // åªèƒ½æ˜¯é¢„å®šä¹‰çš„çœä»½
};
```

### 2. è¿è¡Œæ—¶éªŒè¯
```typescript
// ä½¿ç”¨ Zod è¿›è¡Œè¿è¡Œæ—¶éªŒè¯
const result = RegisterSchema.parse(formData);
// å¦‚æœæ•°æ®ä¸ç¬¦åˆ schemaï¼Œä¼šæŠ›å‡ºè¯¦ç»†é”™è¯¯
```

### 3. æ•°æ®åº“ç±»å‹å®‰å…¨
```typescript
// Drizzle ORM æä¾›ç±»å‹å®‰å…¨çš„æŸ¥è¯¢
const users = await db
  .select()
  .from(usersTable)
  .where(eq(usersTable.province, "AB"));
// users çš„ç±»å‹ä¼šè‡ªåŠ¨æ¨å¯¼ä¸º User[]
```

## ğŸš€ æ‰©å±•æ€§è®¾è®¡

### æ·»åŠ æ–°åº”ç”¨
```bash
# åˆ›å»ºæ–°åº”ç”¨
mkdir apps/new-app
cd apps/new-app

# å®‰è£…å…±äº«ä¾èµ–
bun add shared workspace:*
bun add database workspace:*
```

### æ·»åŠ æ–°åŠŸèƒ½
1. åœ¨ `shared` ä¸­å®šä¹‰ç±»å‹
2. åœ¨ `database` ä¸­æ·»åŠ  schema
3. åœ¨å„åº”ç”¨ä¸­å®ç°åŠŸèƒ½
4. äº«å—ç«¯åˆ°ç«¯çš„ç±»å‹å®‰å…¨

### æ€§èƒ½ä¼˜åŒ–
- **Turborepo**: å¢é‡æ„å»ºå’Œç¼“å­˜
- **TypeScript Project References**: å¿«é€Ÿç±»å‹æ£€æŸ¥
- **Bun**: æ›´å¿«çš„åŒ…ç®¡ç†å’Œè¿è¡Œæ—¶

## ğŸ“ˆ ç›‘æ§å’Œç»´æŠ¤

### ä»£ç è´¨é‡
```bash
bun run type-check    # TypeScript ç±»å‹æ£€æŸ¥
bun run lint          # ä»£ç è§„èŒƒæ£€æŸ¥
bun run test          # å•å…ƒæµ‹è¯• (å¾…æ·»åŠ )
```

### ä¾èµ–ç®¡ç†
```bash
bun outdated          # æ£€æŸ¥è¿‡æœŸä¾èµ–
bun audit             # å®‰å…¨æ¼æ´æ£€æŸ¥
```

---

è¿™ä¸ªæ¶æ„ç¡®ä¿äº†ï¼š
- âœ… ç±»å‹å®‰å…¨
- âœ… ä»£ç å¤ç”¨
- âœ… å¼€å‘æ•ˆç‡
- âœ… ç»´æŠ¤æ€§
- âœ… æ‰©å±•æ€§ 