# åŠ æ‹¿å¤§é©¾è€ƒ App - Monorepo é¡¹ç›®

ğŸš— ä¸€ä¸ªä¸“ä¸ºä¸­å›½ç”¨æˆ·è®¾è®¡çš„åŠ æ‹¿å¤§é©¾é©¶æ‰§ç…§è€ƒè¯•åº”ç”¨ï¼Œé‡‡ç”¨ç°ä»£åŒ– Monorepo æ¶æ„å®ç°å‰åç«¯å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚

## âœ¨ é¡¹ç›®äº®ç‚¹

- ğŸš€ **æœ€æ–°æŠ€æœ¯æ ˆ**: Next.js 15 + React 19 + TypeScript + Expo
- ğŸ¨ **ç°ä»£UIè®¾è®¡**: shadcn/ui + Tailwind CSS + NativeWind 
- ğŸ“± **è·¨å¹³å°æ”¯æŒ**: iOS / Android / Web ä¸‰ç«¯ç»Ÿä¸€
- ğŸ”§ **ç±»å‹å®‰å…¨**: å®Œæ•´çš„ TypeScript ç±»å‹å…±äº«
- âš¡ **é«˜æ€§èƒ½æ„å»º**: pnpm + Turborepo ä¼˜åŒ–æ„å»º
- ğŸ—„ï¸ **ç°ä»£æ•°æ®åº“**: Drizzle ORM + PostgreSQL
- ğŸ” **å®Œæ•´æƒé™æ§åˆ¶**: å¤šç”¨æˆ·ç±»å‹ã€å†…å®¹åˆ†çº§ã€é¢„è§ˆæœºåˆ¶
- ğŸŒ **å›½é™…åŒ–æ”¯æŒ**: ä¸­è‹±æ–‡åŒè¯­å†…å®¹ç®¡ç†

## ğŸ¯ å½“å‰å®ŒæˆçŠ¶æ€

### âœ… å·²å®Œæˆæ¨¡å—

#### ğŸ”§ **Admin ç®¡ç†åå°** (100% å®Œæˆ)
- âœ… **å®Œæ•´çš„APIç³»ç»Ÿ**: 15+ä¸ªAPIç«¯ç‚¹ï¼Œæ”¯æŒCRUDæ“ä½œ
- âœ… **Handbookç®¡ç†**: ç« èŠ‚ã€æ®µè½ã€å›¾ç‰‡çš„å®Œæ•´ç®¡ç†
- âœ… **æƒé™æ§åˆ¶**: åŸºäºç”¨æˆ·ç±»å‹çš„è®¿é—®æ§åˆ¶
- âœ… **å¤šè¯­è¨€æ”¯æŒ**: ä¸­è‹±æ–‡å†…å®¹ç®¡ç†
- âœ… **å›¾ç‰‡ç®¡ç†**: äº‘å­˜å‚¨é›†æˆ (Vercel Blob)
- âœ… **æ•°æ®éªŒè¯**: Zod + TypeScript åŒé‡ä¿éšœ
- âœ… **é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„é”™è¯¯å“åº”æ ¼å¼

#### ğŸ“Š **Database æ•°æ®åº“** (100% å®Œæˆ)
- âœ… **å®Œæ•´Schema**: ç”¨æˆ·ã€æ‰‹å†Œã€æµ‹éªŒã€è¿›åº¦ã€ç³»ç»Ÿè¡¨
- âœ… **å…³ç³»è®¾è®¡**: å¤–é”®çº¦æŸã€çº§è”æ“ä½œ
- âœ… **ç±»å‹å®‰å…¨**: Drizzle ORM + TypeScript
- âœ… **ç‰ˆæœ¬æ§åˆ¶**: å†…å®¹ç‰ˆæœ¬ç®¡ç†
- âœ… **æƒé™åˆ†çº§**: FREE/TRIAL/MEMBER ç”¨æˆ·ç±»å‹

#### ğŸ”— **Shared Types** (100% å®Œæˆ)
- âœ… **APIç±»å‹**: è¯·æ±‚/å“åº”/é”™è¯¯ä»£ç 
- âœ… **æ•°æ®æ¨¡å‹**: å®Œæ•´çš„å®ä½“ç±»å‹å®šä¹‰
- âœ… **éªŒè¯Schema**: Zod éªŒè¯æ¨¡å¼
- âœ… **å·¥å…·å‡½æ•°**: å¸¸ç”¨å·¥å…·å’Œå¸¸é‡

### ğŸš§ å¾…å¼€å‘æ¨¡å—

#### ğŸ“± **Mobile App** (æ¶æ„å°±ç»ª)
- ğŸ—ï¸ **åŸºç¡€æ¶æ„**: Expo + React Navigation å·²é…ç½®
- ğŸ”² **å±å¹•å®ç°**: 19ä¸ªæ ¸å¿ƒå±å¹•å¾…å¼€å‘
- ğŸ”² **çŠ¶æ€ç®¡ç†**: Zustand store å¾…å®ç°
- ğŸ”² **APIé›†æˆ**: è°ƒç”¨åç«¯APIæ¥å£

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [APIæ–‡æ¡£](#apiæ–‡æ¡£)
- [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
- [æ•°æ®åº“è®¾è®¡](#æ•°æ®åº“è®¾è®¡)
- [éƒ¨ç½²è¯´æ˜](#éƒ¨ç½²è¯´æ˜)

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
CDT/
â”œâ”€â”€ apps/                          # åº”ç”¨ç¨‹åº
â”‚   â”œâ”€â”€ admin/                     # âœ… Next.js ç®¡ç†åå° (å·²å®Œæˆ)
â”‚   â”‚   â”œâ”€â”€ src/app/api/           # API è·¯ç”± (15+ ç«¯ç‚¹)
â”‚   â”‚   â”‚   â”œâ”€â”€ content/           # å†…å®¹ç®¡ç† API
â”‚   â”‚   â”‚   â”œâ”€â”€ handbook/          # æ‰‹å†Œç®¡ç† API  
â”‚   â”‚   â”‚   â”œâ”€â”€ images/            # å›¾ç‰‡ä¸Šä¼  API
â”‚   â”‚   â”‚   â””â”€â”€ mobile/            # ç§»åŠ¨ç«¯ API
â”‚   â”‚   â”œâ”€â”€ src/components/        # shadcn/ui ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ src/lib/               # æ•°æ®åº“è¿æ¥ã€è®¤è¯ã€å·¥å…·
â”‚   â”‚   â””â”€â”€ README.md              # ç®¡ç†åå°æ–‡æ¡£
â”‚   â””â”€â”€ mobile/                    # ğŸš§ React Native App (å¾…å¼€å‘)
â”‚       â”œâ”€â”€ app/                   # Expo Router é¡µé¢
â”‚       â”œâ”€â”€ components/            # ç§»åŠ¨ç«¯ç»„ä»¶
â”‚       â”œâ”€â”€ stores/                # Zustand çŠ¶æ€ç®¡ç†
â”‚       â””â”€â”€ README.md              # ç§»åŠ¨ç«¯å¼€å‘æ–‡æ¡£
â”œâ”€â”€ packages/                      # å…±äº«åŒ…
â”‚   â”œâ”€â”€ shared/                    # âœ… å…±äº«ç±»å‹å’Œå·¥å…· (å·²å®Œæˆ)
â”‚   â”‚   â”œâ”€â”€ src/types/             # TypeScript ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ src/utils/             # å·¥å…·å‡½æ•°å’ŒéªŒè¯
â”‚   â”‚   â””â”€â”€ README.md              # ç±»å‹åŒ…æ–‡æ¡£
â”‚   â””â”€â”€ database/                  # âœ… æ•°æ®åº“å±‚ (å·²å®Œæˆ)
â”‚       â”œâ”€â”€ src/schema/            # Drizzle ORM Schema
â”‚       â”œâ”€â”€ src/migrations/        # æ•°æ®åº“è¿ç§»
â”‚       â”œâ”€â”€ src/seed/              # ç§å­æ•°æ®
â”‚       â””â”€â”€ README.md              # æ•°æ®åº“æ–‡æ¡£
â”œâ”€â”€ package.json                   # æ ¹ package.json
â”œâ”€â”€ turbo.json                     # Turborepo é…ç½®
â””â”€â”€ README.md                      # é¡¹ç›®æ€»è§ˆ
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### ğŸ”§ **åç«¯ / Admin** (âœ… å·²å®Œæˆ)
- **Next.js 15** - App Router + API Routes
- **TypeScript** - å®Œæ•´ç±»å‹å®‰å…¨
- **Drizzle ORM** - ç±»å‹å®‰å…¨çš„æ•°æ®åº“æ“ä½œ
- **PostgreSQL** - å…³ç³»å‹æ•°æ®åº“
- **Zod** - è¿è¡Œæ—¶ç±»å‹éªŒè¯
- **JWT** - ç”¨æˆ·è®¤è¯
- **Vercel Blob** - æ–‡ä»¶å­˜å‚¨
- **shadcn/ui** - ç°ä»£UIç»„ä»¶

### ğŸ“± **å‰ç«¯ / Mobile** (ğŸš§ å¾…å¼€å‘)
- **Expo 52** - è·¨å¹³å°å¼€å‘æ¡†æ¶
- **React Native** - åŸç”Ÿç§»åŠ¨åº”ç”¨
- **TypeScript** - ç±»å‹å®‰å…¨
- **Zustand** - è½»é‡çº§çŠ¶æ€ç®¡ç†
- **TanStack Query** - æ•°æ®è·å–å’Œç¼“å­˜
- **NativeWind** - Tailwind for RN
- **Expo Router** - æ–‡ä»¶ç³»ç»Ÿè·¯ç”±

### ğŸ”— **å·¥å…·é“¾**
- **pnpm** - åŒ…ç®¡ç†å™¨
- **Turborepo** - å•ä½“ä»“åº“æ„å»ºç³»ç»Ÿ
- **TypeScript Project References** - åŒ…é—´ç±»å‹å…±äº«

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Node.js 20+** 
- **pnpm 9.0+**
- **PostgreSQL** æ•°æ®åº“
- **Expo CLI** (ç§»åŠ¨ç«¯å¼€å‘)

### ä¸€é”®å¯åŠ¨

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd CDT

# å®‰è£…æ‰€æœ‰ä¾èµ–
pnpm install

# æ„å»ºå…±äº«åŒ…
pnpm build

# é…ç½®æ•°æ®åº“ (åˆ›å»º .env.local)
cp apps/admin/.env.example apps/admin/.env.local
# ç¼–è¾‘æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²

# å¯åŠ¨ç®¡ç†åå°
pnpm admin
# è®¿é—® http://localhost:3000

# å¯åŠ¨ç§»åŠ¨ç«¯ (å¦å¼€ç»ˆç«¯)
pnpm mobile
```

## ğŸ“Š API æ–‡æ¡£

### ğŸ”§ **Admin API** (ç®¡ç†ç«¯)

#### ç« èŠ‚ç®¡ç†
```bash
POST   /api/handbook/chapters        # åˆ›å»ºç« èŠ‚
GET    /api/handbook/chapters        # è·å–ç« èŠ‚åˆ—è¡¨
GET    /api/handbook/chapters/[id]   # è·å–ç« èŠ‚è¯¦æƒ…
PUT    /api/handbook/chapters/[id]   # æ›´æ–°ç« èŠ‚
DELETE /api/handbook/chapters/[id]   # åˆ é™¤ç« èŠ‚
```

#### å†…å®¹ç®¡ç†
```bash
POST   /api/content/save            # åˆ›å»º/æ›´æ–°æ®µè½
GET    /api/content/save            # è·å–æ®µè½åˆ—è¡¨
GET    /api/content/[id]            # è·å–æ®µè½å†…å®¹
PUT    /api/content/[id]            # æ›´æ–°æ®µè½
DELETE /api/content/[id]            # åˆ é™¤æ®µè½
```

#### å›¾ç‰‡ç®¡ç†
```bash
POST   /api/images/upload           # ä¸Šä¼ å›¾ç‰‡
GET    /api/images/upload           # è·å–å›¾ç‰‡åˆ—è¡¨
```

### ğŸ“± **Mobile API** (ç”¨æˆ·ç«¯)

#### å†…å®¹è·å–
```bash
GET /api/mobile/chapters?userType=FREE&language=ZH
# å“åº”åŒ…å«æƒé™æ§åˆ¶çš„ç« èŠ‚åˆ—è¡¨

GET /api/mobile/content/[id]?userType=MEMBER&language=EN  
# å“åº”åŒ…å«æƒé™è¿‡æ»¤çš„å†…å®¹
```

### ğŸ” **æƒé™æ§åˆ¶**

#### ç”¨æˆ·ç±»å‹
- **FREE** - å…è´¹ç”¨æˆ· (å¯è®¿é—®å…è´¹å†…å®¹ + é¢„è§ˆ)
- **TRIAL** - è¯•ç”¨ç”¨æˆ· (å¯è®¿é—®è¯•ç”¨å†…å®¹)
- **MEMBER** - ä¼šå‘˜ç”¨æˆ· (å¯è®¿é—®æ‰€æœ‰å†…å®¹)

#### å†…å®¹åˆ†çº§
- **FREE** - æ‰€æœ‰ç”¨æˆ·å¯è®¿é—®
- **TRIAL_INCLUDED** - è¯•ç”¨å’Œä¼šå‘˜å¯è®¿é—®  
- **MEMBER_ONLY** - ä»…ä¼šå‘˜å¯è®¿é—®
- **PREMIUM** - é«˜çº§ä¼šå‘˜å†…å®¹

### ğŸ“ **API å“åº”æ ¼å¼**

#### æˆåŠŸå“åº”
```json
{
  "success": true,
  "data": { ... },
  "message": "æ“ä½œæˆåŠŸ",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

#### é”™è¯¯å“åº”
```json
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "å‚æ•°éªŒè¯å¤±è´¥",
    "details": { ... }
  },
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

## ğŸ¯ å¼€å‘æŒ‡å—

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
# ç®¡ç†åå° (å·²å®Œæˆ)
pnpm admin                    # å¯åŠ¨åœ¨ localhost:3000
cd apps/admin && pnpm dev     # æˆ–è€…è¿›å…¥ç›®å½•å¯åŠ¨

# ç§»åŠ¨ç«¯åº”ç”¨ (å¾…å¼€å‘)
pnpm mobile                   # å¯åŠ¨ Expo å¼€å‘æœåŠ¡å™¨
cd apps/mobile && pnpm dev   # æˆ–è€…è¿›å…¥ç›®å½•å¯åŠ¨
```

### æ•°æ®åº“æ“ä½œ

```bash
# ç”Ÿæˆè¿ç§»æ–‡ä»¶
pnpm db:generate

# æ‰§è¡Œè¿ç§»
pnpm db:migrate

# æ•°æ®åº“ç®¡ç†ç•Œé¢
pnpm db:studio

# æ’­ç§æµ‹è¯•æ•°æ®
cd packages/database && pnpm seed
```

### æ„å»ºå’Œç±»å‹æ£€æŸ¥

```bash
# æ„å»ºæ‰€æœ‰åŒ…
pnpm build

# ç±»å‹æ£€æŸ¥
pnpm type-check

# ç‰¹å®šåŒ…æ“ä½œ
pnpm build --filter admin
pnpm type-check --filter mobile
```

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒè¡¨ç»“æ„

#### ğŸ‘¥ **ç”¨æˆ·ç³»ç»Ÿ**
- `users` - ç”¨æˆ·åŸºæœ¬ä¿¡æ¯
- `verification_codes` - éªŒè¯ç ç®¡ç†

#### ğŸ“š **æ‰‹å†Œç³»ç»Ÿ**  
- `handbook_chapters` - ç« èŠ‚ä¿¡æ¯
- `handbook_sections` - æ®µè½å†…å®¹
- `handbook_images` - å›¾ç‰‡èµ„æº
- `handbook_content_versions` - ç‰ˆæœ¬æ§åˆ¶

#### ğŸ§  **æµ‹éªŒç³»ç»Ÿ**
- `questions` - é¢˜ç›®åº“
- `question_options` - é€‰é¡¹
- `quiz_sessions` - æµ‹éªŒä¼šè¯
- `user_answers` - ç­”é¢˜è®°å½•

#### ğŸ“ˆ **è¿›åº¦ç³»ç»Ÿ**
- `chapter_progress` - å­¦ä¹ è¿›åº¦
- `wrong_questions` - é”™é¢˜æœ¬
- `learning_stats` - å­¦ä¹ ç»Ÿè®¡

#### âš™ï¸ **ç³»ç»Ÿç®¡ç†**
- `app_configs` - åº”ç”¨é…ç½®
- `notifications` - é€šçŸ¥ç®¡ç†
- `feedback` - ç”¨æˆ·åé¦ˆ

## ğŸš€ éƒ¨ç½²è¯´æ˜

### Admin ç®¡ç†åå°

```bash
# Vercel éƒ¨ç½²
cd apps/admin
pnpm build
npx vercel --prod

# ç¯å¢ƒå˜é‡é…ç½®
DATABASE_URL=postgresql://...
JWT_SECRET=your-secret
BLOB_READ_WRITE_TOKEN=vercel-blob-token
```

### Mobile åº”ç”¨

```bash
# Expo æ„å»º
cd apps/mobile
pnpm build
expo build:ios
expo build:android

# å‘å¸ƒåˆ°åº”ç”¨å•†åº—
expo submit
```

## ğŸ“š è¯¦ç»†æ–‡æ¡£

æ¯ä¸ªæ¨¡å—éƒ½æœ‰è¯¦ç»†çš„ README æ–‡æ¡£ï¼š

- ğŸ“– [Admin ç®¡ç†åå°](./apps/admin/README.md) - API è¯¦ç»†è¯´æ˜
- ğŸ“± [Mobile ç§»åŠ¨ç«¯](./apps/mobile/README.md) - å¼€å‘æŒ‡å—  
- ğŸ—„ï¸ [Database æ•°æ®åº“](./packages/database/README.md) - Schema è®¾è®¡
- ğŸ”— [Shared å…±äº«åŒ…](./packages/shared/README.md) - ç±»å‹å®šä¹‰

## ğŸ‰ ä¸‹ä¸€æ­¥å¼€å‘è®¡åˆ’

### ğŸ“± ç§»åŠ¨ç«¯å¼€å‘ (ä¼˜å…ˆçº§: é«˜)
1. **ç”¨æˆ·è®¤è¯æ¨¡å—** - å¾®ä¿¡/é‚®ç®±/æ‰‹æœºç™»å½•
2. **çœä»½é€‰æ‹©å’Œè®¾ç½®** - åœ°åŒºåŒ–å†…å®¹
3. **æ‰‹å†Œé˜…è¯»åŠŸèƒ½** - ç« èŠ‚æµè§ˆã€è¿›åº¦è¿½è¸ª
4. **ç»ƒä¹ æ¨¡å¼** - ç« èŠ‚ç»ƒä¹ ã€é”™é¢˜å¤ä¹ 
5. **æ¨¡æ‹Ÿè€ƒè¯•** - éšæœºé¢˜ç›®ã€è®¡æ—¶åŠŸèƒ½
6. **ç”¨æˆ·ä¸­å¿ƒ** - ä¸ªäººä¿¡æ¯ã€ä¼šå‘˜ç®¡ç†

### ğŸ”§ åç«¯å¢å¼º (ä¼˜å…ˆçº§: ä¸­)
1. **é¢˜ç›®ç®¡ç† API** - å®Œæ•´çš„é¢˜åº“ CRUD
2. **ç”¨æˆ·è¿›åº¦ API** - å­¦ä¹ æ•°æ®ç»Ÿè®¡
3. **å®æ—¶é€šçŸ¥** - WebSocket æ¶ˆæ¯æ¨é€
4. **æ•°æ®åˆ†æ** - ç”¨æˆ·è¡Œä¸ºç»Ÿè®¡

### ğŸ¨ åŠŸèƒ½å®Œå–„ (ä¼˜å…ˆçº§: ä½)
1. **Admin UI ç•Œé¢** - å¯è§†åŒ–ç®¡ç†ç•Œé¢
2. **é«˜çº§æƒé™æ§åˆ¶** - è§’è‰²ç®¡ç†
3. **å†…å®¹å®¡æ ¸æµç¨‹** - å‘å¸ƒå®¡æ‰¹
4. **å¤šç§Ÿæˆ·æ”¯æŒ** - ä¸åŒçœä»½ç‹¬ç«‹ç®¡ç†

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

---

**ğŸ¯ ç°åœ¨ç®¡ç†åå°å·²ç»å®Œæˆï¼Œæ˜¯æ—¶å€™å¼€å‘ç§»åŠ¨ç«¯åº”ç”¨äº†ï¼ğŸš€** 